{"version":3,"file":"index.min.js","sources":["../../runtime/bridge/CallbackManager.js","../../runtime/shared/utils.js","../../runtime/vdom/operation.js","../../runtime/vdom/Node.js","../../runtime/vdom/WeexElement.js","../../runtime/vdom/Element.js","../../runtime/bridge/TaskCenter.js","../../runtime/bridge/receiver.js","../../runtime/bridge/normalize.js","../../runtime/api/module.js","../../runtime/api/component.js","../../runtime/api/service.js","../../runtime/vdom/Comment.js","../../runtime/bridge/Listener.js","../../runtime/bridge/Handler.js","../../runtime/vdom/Document.js","../../runtime/api/WeexInstance.js","../../runtime/api/init.js","../../runtime/api/config.js","../../runtime/api/index.js"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nfunction getHookKey (componentId, type, hookName) {\n  return `${type}@${hookName}#${componentId}`\n}\n\n/**\n * For general callback management of a certain Weex instance.\n * Because function can not passed into native, so we create callback\n * callback id for each function and pass the callback id into native\n * in fact. And when a callback called from native, we can find the real\n * callback through the callback id we have passed before.\n */\nexport default class CallbackManager {\n  constructor (instanceId) {\n    this.instanceId = String(instanceId)\n    this.lastCallbackId = 0\n    this.callbacks = {}\n    this.hooks = {}\n  }\n  add (callback) {\n    this.lastCallbackId++\n    this.callbacks[this.lastCallbackId] = callback\n    return this.lastCallbackId\n  }\n  remove (callbackId) {\n    const callback = this.callbacks[callbackId]\n    delete this.callbacks[callbackId]\n    return callback\n  }\n  registerHook (componentId, type, hookName, hookFunction) {\n    // TODO: validate arguments\n    const key = getHookKey(componentId, type, hookName)\n    if (this.hooks[key]) {\n      console.warn(`[JS Framework] Override an existing component hook \"${key}\".`)\n    }\n    this.hooks[key] = hookFunction\n  }\n  triggerHook (componentId, type, hookName, args) {\n    // TODO: validate arguments\n    const key = getHookKey(componentId, type, hookName)\n    const hookFunction = this.hooks[key]\n    if (typeof hookFunction !== 'function') {\n      console.error(`[JS Framework] Invalid hook function type (${typeof hookFunction}) on \"${key}\".`)\n      return null\n    }\n    let result = null\n    try {\n      result = hookFunction.apply(null, args || [])\n    }\n    catch (e) {\n      console.error(`[JS Framework] Failed to execute the hook function on \"${key}\".`)\n      throw e\n    }\n    return result\n  }\n  consume (callbackId, data, ifKeepAlive) {\n    const callback = this.callbacks[callbackId]\n    if (typeof ifKeepAlive === 'undefined' || ifKeepAlive === false) {\n      delete this.callbacks[callbackId]\n    }\n    if (typeof callback === 'function') {\n      try {\n        return callback.call(null, data)\n      }\n      catch (error) {\n        console.error(`[JS Framework] Failed to execute the callback function:\\n ${error.toString()}`)\n        throw error\n      }\n    }\n    return new Error(`invalid callback id \"${callbackId}\"`)\n  }\n  close () {\n    this.callbacks = {}\n    this.hooks = {}\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/**\n * Get a unique id.\n */\nlet nextNodeRef = 1\nexport function uniqueId () {\n  return (nextNodeRef++).toString()\n}\n\nexport function typof (v) {\n  const s = Object.prototype.toString.call(v)\n  return s.substring(8, s.length - 1)\n}\n\nexport function isPlainObject (value) {\n  return Object.prototype.toString.call(value) === '[object Object]'\n}\n\nexport function hasOwn (object, key) {\n  return isPlainObject(object) && Object.prototype.hasOwnProperty.call(object, key)\n}\n\nexport function bufferToBase64 (buffer) {\n  if (typeof btoa !== 'function') {\n    return ''\n  }\n  const string = Array.prototype.map.call(\n    new Uint8Array(buffer),\n    code => String.fromCharCode(code)\n  ).join('')\n  return btoa(string) // eslint-disable-line no-undef\n}\n\nexport function base64ToBuffer (base64) {\n  if (typeof atob !== 'function') {\n    return new ArrayBuffer(0)\n  }\n  const string = atob(base64) // eslint-disable-line no-undef\n  const array = new Uint8Array(string.length)\n  Array.prototype.forEach.call(string, (ch, i) => {\n    array[i] = ch.charCodeAt(0)\n  })\n  return array.buffer\n}\n\n/**\n * Detect if the param is falsy or empty\n * @param {any} any\n */\nexport function isEmpty (any) {\n  if (!any || typeof any !== 'object') {\n    return true\n  }\n\n  for (const key in any) {\n    if (Object.prototype.hasOwnProperty.call(any, key)) {\n      return false\n    }\n  }\n  return true\n}\n\nconst LEVELS = ['off', 'error', 'warn', 'info', 'log', 'debug']\nlet levelMap = {}\n\n/**\n * Generate map for which types of message will be sent in a certain message level\n * as the order of LEVELS.\n */\nexport function generateLevelMap () {\n  LEVELS.forEach(level => {\n    const levelIndex = LEVELS.indexOf(level)\n    levelMap[level] = {}\n    LEVELS.forEach(type => {\n      const typeIndex = LEVELS.indexOf(type)\n      if (typeIndex <= levelIndex) {\n        levelMap[level][type] = true\n      }\n    })\n  })\n}\n\n/**\n * Reset level map to empty object,\n * then the log level can be toggled at runtime.\n */\nexport function resetLevelMap () {\n  levelMap = {}\n}\n\n/**\n * Check if a certain type of message will be sent in current log level of env.\n * @param  {string} type\n * @return {boolean}\n */\nexport function checkLevel (type) {\n  const logLevel = (global.WXEnvironment && global.WXEnvironment.logLevel) || 'log'\n  return levelMap[logLevel] && levelMap[logLevel][type]\n}\n\n/**\n * Print debug log regardless of level check.\n *\n * This methods can avoid \"double level check\" compared with using wrapped console.debug\n */\nexport function debugLog (text) {\n  global.nativeLog('wxInteractionAnalyzer: [jsfm]' + text, '__DEBUG')\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nconst docMap = {}\n\n/**\n * Add a document object into docMap.\n * @param {string} id\n * @param {object} document\n */\nexport function addDoc (id, doc) {\n  if (id) {\n    docMap[id] = doc\n  }\n}\n\n/**\n * Get the document object by id.\n * @param {string} id\n */\nexport function getDoc (id) {\n  return docMap[id]\n}\n\n/**\n * Remove the document from docMap by id.\n * @param {string} id\n */\nexport function removeDoc (id) {\n  delete docMap[id]\n}\n\n/**\n * @deprecated\n * Get listener by document id.\n * @param {string} id\n * @return {object} listener\n */\nexport function getListener (id) {\n  const doc = docMap[id]\n  if (doc && doc.listener) {\n    return doc.listener\n  }\n  return null\n}\n\n/**\n * Get TaskCenter instance by id.\n * @param {string} id\n * @return {object} TaskCenter\n */\nexport function getTaskCenter (id) {\n  const doc = docMap[id]\n  if (doc && doc.taskCenter) {\n    return doc.taskCenter\n  }\n  return null\n}\n\n/**\n * Append body node to documentElement.\n * @param {object} document\n * @param {object} node\n * @param {object} before\n */\nexport function appendBody (doc, node, before) {\n  const { documentElement } = doc\n\n  if (documentElement.pureChildren.length > 0 || node.parentNode) {\n    return\n  }\n  const children = documentElement.children\n  const beforeIndex = children.indexOf(before)\n  if (beforeIndex < 0) {\n    children.push(node)\n  }\n  else {\n    children.splice(beforeIndex, 0, node)\n  }\n\n  if (node.nodeType === 1) {\n    if (node.role === 'body') {\n      node.docId = doc.id\n      node.ownerDocument = doc\n      node.parentNode = documentElement\n      linkParent(node, documentElement)\n    }\n    else {\n      node.children.forEach(child => {\n        child.parentNode = node\n      })\n      setBody(doc, node)\n      node.docId = doc.id\n      node.ownerDocument = doc\n      linkParent(node, documentElement)\n      delete doc.nodeMap[node.nodeId]\n    }\n    documentElement.pureChildren.push(node)\n    sendBody(doc, node)\n  }\n  else {\n    node.parentNode = documentElement\n    doc.nodeMap[node.ref] = node\n  }\n}\n\nfunction sendBody (doc, node) {\n  const body = node.toJSON()\n  if (doc && doc.taskCenter && typeof doc.taskCenter.send === 'function') {\n    doc.taskCenter.send('dom', { action: 'createBody' }, [body])\n  }\n}\n\n/**\n * Set up body node.\n * @param {object} document\n * @param {object} element\n */\nexport function setBody (doc, el) {\n  el.role = 'body'\n  el.depth = 1\n  delete doc.nodeMap[el.nodeId]\n  el.ref = '_root'\n  doc.nodeMap._root = el\n  doc.body = el\n}\n\n/**\n * Establish the connection between parent and child node.\n * @param {object} child node\n * @param {object} parent node\n */\nexport function linkParent (node, parent) {\n  node.parentNode = parent\n  if (parent.docId) {\n    node.docId = parent.docId\n    node.ownerDocument = parent.ownerDocument\n    node.ownerDocument.nodeMap[node.nodeId] = node\n    node.depth = parent.depth + 1\n  }\n  node.children.forEach(child => {\n    linkParent(child, node)\n  })\n}\n\n/**\n * Get the next sibling element.\n * @param {object} node\n */\nexport function nextElement (node) {\n  while (node) {\n    if (node.nodeType === 1) {\n      return node\n    }\n    node = node.nextSibling\n  }\n}\n\n/**\n * Get the previous sibling element.\n * @param {object} node\n */\nexport function previousElement (node) {\n  while (node) {\n    if (node.nodeType === 1) {\n      return node\n    }\n    node = node.previousSibling\n  }\n}\n\n/**\n * Insert a node into list at the specified index.\n * @param {object} target node\n * @param {array} list\n * @param {number} newIndex\n * @param {boolean} changeSibling\n * @return {number} newIndex\n */\nexport function insertIndex (target, list, newIndex, changeSibling) {\n  /* istanbul ignore next */\n  if (newIndex < 0) {\n    newIndex = 0\n  }\n  const before = list[newIndex - 1]\n  const after = list[newIndex]\n  list.splice(newIndex, 0, target)\n  if (changeSibling) {\n    before && (before.nextSibling = target)\n    target.previousSibling = before\n    target.nextSibling = after\n    after && (after.previousSibling = target)\n  }\n  return newIndex\n}\n\n/**\n * Move the node to a new index in list.\n * @param {object} target node\n * @param {array} list\n * @param {number} newIndex\n * @param {boolean} changeSibling\n * @return {number} newIndex\n */\nexport function moveIndex (target, list, newIndex, changeSibling) {\n  const index = list.indexOf(target)\n  /* istanbul ignore next */\n  if (index < 0) {\n    return -1\n  }\n  if (changeSibling) {\n    const before = list[index - 1]\n    const after = list[index + 1]\n    before && (before.nextSibling = after)\n    after && (after.previousSibling = before)\n  }\n  list.splice(index, 1)\n  let newIndexAfter = newIndex\n  if (index <= newIndex) {\n    newIndexAfter = newIndex - 1\n  }\n  const beforeNew = list[newIndexAfter - 1]\n  const afterNew = list[newIndexAfter]\n  list.splice(newIndexAfter, 0, target)\n  if (changeSibling) {\n    beforeNew && (beforeNew.nextSibling = target)\n    target.previousSibling = beforeNew\n    target.nextSibling = afterNew\n    afterNew && (afterNew.previousSibling = target)\n  }\n  if (index === newIndexAfter) {\n    return -1\n  }\n  return newIndex\n}\n\n/**\n * Remove the node from list.\n * @param {object} target node\n * @param {array} list\n * @param {boolean} changeSibling\n */\nexport function removeIndex (target, list, changeSibling) {\n  const index = list.indexOf(target)\n  /* istanbul ignore next */\n  if (index < 0) {\n    return\n  }\n  if (changeSibling) {\n    const before = list[index - 1]\n    const after = list[index + 1]\n    before && (before.nextSibling = after)\n    after && (after.previousSibling = before)\n  }\n  list.splice(index, 1)\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { uniqueId } from '../shared/utils'\nimport { getDoc } from './operation'\n\nexport default class Node {\n  constructor () {\n    this.nodeId = uniqueId()\n    this.ref = this.nodeId\n    this.children = []\n    this.pureChildren = []\n    this.parentNode = null\n    this.nextSibling = null\n    this.previousSibling = null\n  }\n\n  /**\n  * Destroy current node, and remove itself form nodeMap.\n  */\n  destroy () {\n    const doc = getDoc(this.docId)\n    if (doc) {\n      delete this.docId\n      delete doc.nodeMap[this.nodeId]\n    }\n    this.children.forEach(child => {\n      child.destroy()\n    })\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { getTaskCenter } from './operation'\n\nlet Element\n\nexport function setElement (El) {\n  Element = El\n}\n\n/**\n * A map which stores all type of elements.\n * @type {Object}\n */\nconst registeredElements = {}\n\n/**\n * Register an extended element type with component methods.\n * @param  {string} type    component type\n * @param  {array}  methods a list of method names\n */\nexport function registerElement (type, methods) {\n  // Skip when no special component methods.\n  if (!Array.isArray(methods) || !methods.length) {\n    return\n  }\n\n  // Init constructor.\n  class WeexElement extends Element {}\n\n  // Add methods to prototype.\n  methods.forEach(methodName => {\n    WeexElement.prototype[methodName] = function (...args) {\n      const taskCenter = getTaskCenter(this.docId)\n      if (taskCenter) {\n        return taskCenter.send('component', {\n          ref: this.ref,\n          component: type,\n          method: methodName\n        }, args)\n      }\n    }\n  })\n\n  // Add to element type map.\n  registeredElements[type] = WeexElement\n}\n\nexport function unregisterElement (type) {\n  delete registeredElements[type]\n}\n\nexport function getWeexElement (type) {\n  return registeredElements[type]\n}\n\nexport function isWeexElement (type) {\n  return !!registeredElements[type]\n}\n\n/**\n * Clear all element types. Only for testing.\n */\nexport function clearWeexElements () {\n  for (const type in registeredElements) {\n    unregisterElement(type)\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport Node from './Node'\nimport {\n  getDoc,\n  getTaskCenter,\n  linkParent,\n  nextElement,\n  previousElement,\n  insertIndex,\n  moveIndex,\n  removeIndex\n} from './operation'\nimport { uniqueId, isEmpty, checkLevel, debugLog } from '../shared/utils'\nimport { getWeexElement, setElement } from './WeexElement'\n\nconst DEFAULT_TAG_NAME = 'div'\nconst BUBBLE_EVENTS = [\n  'click', 'longpress', 'touchstart', 'touchmove', 'touchend',\n  'panstart', 'panmove', 'panend', 'horizontalpan', 'verticalpan', 'swipe'\n]\n\nfunction registerNode (docId, node) {\n  const doc = getDoc(docId)\n  doc.nodeMap[node.nodeId] = node\n}\n\nexport default class Element extends Node {\n  constructor (type = DEFAULT_TAG_NAME, props, isExtended) {\n    super()\n\n    const WeexElement = getWeexElement(type)\n    if (WeexElement && !isExtended) {\n      return new WeexElement(type, props, true)\n    }\n\n    props = props || {}\n    this.nodeType = 1\n    this.nodeId = uniqueId()\n    this.ref = this.nodeId\n    this.type = type\n    this.attr = props.attr || {}\n    this.style = props.style || {}\n    this.classStyle = props.classStyle || {}\n    this.event = {}\n    this.children = []\n    this.pureChildren = []\n  }\n\n  /**\n   * Append a child node.\n   * @param {object} node\n   * @return {undefined | number} the signal sent by native\n   */\n  appendChild (node) {\n    if (node.parentNode && node.parentNode !== this) {\n      return\n    }\n    /* istanbul ignore else */\n    if (!node.parentNode) {\n      if (checkLevel('debug')) {\n        debugLog(`[appendChild](${this.docId},${node.type},${node.ref}) `\n          + `Append <${node.type}> to <${this.type}> (${this.ref}).`)\n      }\n      linkParent(node, this)\n      insertIndex(node, this.children, this.children.length, true)\n      if (this.docId) {\n        registerNode(this.docId, node)\n      }\n      if (node.nodeType === 1) {\n        insertIndex(node, this.pureChildren, this.pureChildren.length)\n        const taskCenter = getTaskCenter(this.docId)\n        if (taskCenter) {\n          return taskCenter.send(\n            'dom',\n            { action: 'addElement' },\n            [this.ref, node.toJSON(), -1]\n          )\n        }\n      }\n    }\n    else {\n      if (checkLevel('debug')) {\n        debugLog(`[appendChild](${this.docId},${node.type},${node.ref}) `\n          + `Move <${node.type}> to ${this.children.length} of <${this.type}> (${this.ref}).`)\n      }\n      moveIndex(node, this.children, this.children.length, true)\n      if (node.nodeType === 1) {\n        const index = moveIndex(node, this.pureChildren, this.pureChildren.length)\n        const taskCenter = getTaskCenter(this.docId)\n        if (taskCenter && index >= 0) {\n          return taskCenter.send(\n            'dom',\n            { action: 'moveElement' },\n            [node.ref, this.ref, index]\n          )\n        }\n      }\n    }\n  }\n\n  /**\n   * Insert a node before specified node.\n   * @param {object} node\n   * @param {object} before\n   * @return {undefined | number} the signal sent by native\n   */\n  insertBefore (node, before) {\n    if (node.parentNode && node.parentNode !== this) {\n      return\n    }\n    if (node === before || (node.nextSibling && node.nextSibling === before)) {\n      return\n    }\n    if (!node.parentNode) {\n      if (checkLevel('debug')) {\n        debugLog(`[insertBefore](${this.docId},${node.type},${node.ref}) `\n          + `Insert <${node.type}> to <${this.type}> (${this.ref}), before (${before.ref}).`)\n      }\n      linkParent(node, this)\n      insertIndex(node, this.children, this.children.indexOf(before), true)\n      if (this.docId) {\n        registerNode(this.docId, node)\n      }\n      if (node.nodeType === 1) {\n        const pureBefore = nextElement(before)\n        const index = insertIndex(\n          node,\n          this.pureChildren,\n          pureBefore\n            ? this.pureChildren.indexOf(pureBefore)\n            : this.pureChildren.length\n        )\n        const taskCenter = getTaskCenter(this.docId)\n        if (taskCenter) {\n          return taskCenter.send(\n            'dom',\n            { action: 'addElement' },\n            [this.ref, node.toJSON(), index]\n          )\n        }\n      }\n    }\n    else {\n      moveIndex(node, this.children, this.children.indexOf(before), true)\n      if (node.nodeType === 1) {\n        const pureBefore = nextElement(before)\n        /* istanbul ignore next */\n        const index = moveIndex(\n          node,\n          this.pureChildren,\n          pureBefore\n            ? this.pureChildren.indexOf(pureBefore)\n            : this.pureChildren.length\n        )\n        const taskCenter = getTaskCenter(this.docId)\n        if (taskCenter && index >= 0) {\n          return taskCenter.send(\n            'dom',\n            { action: 'moveElement' },\n            [node.ref, this.ref, index]\n          )\n        }\n      }\n    }\n  }\n\n  /**\n   * Insert a node after specified node.\n   * @param {object} node\n   * @param {object} after\n   * @return {undefined | number} the signal sent by native\n   */\n  insertAfter (node, after) {\n    if (node.parentNode && node.parentNode !== this) {\n      return\n    }\n    if (node === after || (node.previousSibling && node.previousSibling === after)) {\n      return\n    }\n    if (!node.parentNode) {\n      if (checkLevel('debug')) {\n        debugLog(`[insertAfter](${this.docId},${node.type},${node.ref}) `\n          + `Insert <${node.type}> to <${this.type}> (${this.ref}), after (${after.ref}).`)\n      }\n      linkParent(node, this)\n      insertIndex(node, this.children, this.children.indexOf(after) + 1, true)\n      /* istanbul ignore else */\n      if (this.docId) {\n        registerNode(this.docId, node)\n      }\n      if (node.nodeType === 1) {\n        const index = insertIndex(\n          node,\n          this.pureChildren,\n          this.pureChildren.indexOf(previousElement(after)) + 1\n        )\n        const taskCenter = getTaskCenter(this.docId)\n        /* istanbul ignore else */\n        if (taskCenter) {\n          return taskCenter.send(\n            'dom',\n            { action: 'addElement' },\n            [this.ref, node.toJSON(), index]\n          )\n        }\n      }\n    }\n    else {\n      moveIndex(node, this.children, this.children.indexOf(after) + 1, true)\n      if (node.nodeType === 1) {\n        const index = moveIndex(\n          node,\n          this.pureChildren,\n          this.pureChildren.indexOf(previousElement(after)) + 1\n        )\n        const taskCenter = getTaskCenter(this.docId)\n        if (taskCenter && index >= 0) {\n          return taskCenter.send(\n            'dom',\n            { action: 'moveElement' },\n            [node.ref, this.ref, index]\n          )\n        }\n      }\n    }\n  }\n\n  /**\n   * Remove a child node, and decide whether it should be destroyed.\n   * @param {object} node\n   * @param {boolean} preserved\n   */\n  removeChild (node, preserved) {\n    if (node.parentNode) {\n      removeIndex(node, this.children, true)\n      if (node.nodeType === 1) {\n        if (checkLevel('debug')) {\n          debugLog(`[removeChild](${this.docId},${node.type},${node.ref}) `\n            + `Remove <${node.type}> from <${this.type}> (${this.ref}).`)\n        }\n        removeIndex(node, this.pureChildren)\n        const taskCenter = getTaskCenter(this.docId)\n        if (taskCenter) {\n          taskCenter.send(\n            'dom',\n            { action: 'removeElement' },\n            [node.ref]\n          )\n        }\n      }\n    }\n    if (!preserved) {\n      node.destroy()\n    }\n  }\n\n  /**\n   * Clear all child nodes.\n   */\n  clear () {\n    const taskCenter = getTaskCenter(this.docId)\n    /* istanbul ignore else */\n    if (taskCenter) {\n      this.pureChildren.forEach(node => {\n        taskCenter.send(\n          'dom',\n          { action: 'removeElement' },\n          [node.ref]\n        )\n      })\n    }\n    this.children.forEach(node => {\n      node.destroy()\n    })\n    this.children.length = 0\n    this.pureChildren.length = 0\n  }\n\n  /**\n   * Set an attribute, and decide whether the task should be send to native.\n   * @param {string} key\n   * @param {string | number} value\n   * @param {boolean} silent\n   */\n  setAttr (key, value, silent) {\n    if (this.attr[key] === value && silent !== false) {\n      return\n    }\n    this.attr[key] = value\n    const taskCenter = getTaskCenter(this.docId)\n    if (!silent && taskCenter) {\n      const result = {}\n      result[key] = value\n      taskCenter.send(\n        'dom',\n        { action: 'updateAttrs' },\n        [this.ref, result]\n      )\n    }\n  }\n\n  /**\n   * Set batched attributes.\n   * @param {object} batchedAttrs\n   * @param {boolean} silent\n   */\n  setAttrs (batchedAttrs, silent) {\n    if (isEmpty(batchedAttrs)) return\n    const mutations = {}\n    for (const key in batchedAttrs) {\n      if (this.attr[key] !== batchedAttrs[key]) {\n        this.attr[key] = batchedAttrs[key]\n        mutations[key] = batchedAttrs[key]\n      }\n    }\n    if (!isEmpty(mutations)) {\n      const taskCenter = getTaskCenter(this.docId)\n      if (!silent && taskCenter) {\n        taskCenter.send(\n          'dom',\n          { action: 'updateAttrs' },\n          [this.ref, mutations]\n        )\n      }\n    }\n  }\n\n  /**\n   * Set a style property, and decide whether the task should be send to native.\n   * @param {string} key\n   * @param {string | number} value\n   * @param {boolean} silent\n   */\n  setStyle (key, value, silent) {\n    if (this.style[key] === value && silent !== false) {\n      return\n    }\n    this.style[key] = value\n    const taskCenter = getTaskCenter(this.docId)\n    if (!silent && taskCenter) {\n      const result = {}\n      result[key] = value\n      taskCenter.send(\n        'dom',\n        { action: 'updateStyle' },\n        [this.ref, result]\n      )\n    }\n  }\n\n  /**\n   * Set batched style properties.\n   * @param {object} batchedStyles\n   * @param {boolean} silent\n   */\n  setStyles (batchedStyles, silent) {\n    if (isEmpty(batchedStyles)) return\n    const mutations = {}\n    for (const key in batchedStyles) {\n      if (this.style[key] !== batchedStyles[key]) {\n        this.style[key] = batchedStyles[key]\n        mutations[key] = batchedStyles[key]\n      }\n    }\n    if (!isEmpty(mutations)) {\n      const taskCenter = getTaskCenter(this.docId)\n      if (!silent && taskCenter) {\n        taskCenter.send(\n          'dom',\n          { action: 'updateStyle' },\n          [this.ref, mutations]\n        )\n      }\n    }\n  }\n\n  /**\n   * Set style properties from class.\n   * @param {object} classStyle\n   */\n  setClassStyle (classStyle) {\n    // reset previous class style to empty string\n    for (const key in this.classStyle) {\n      this.classStyle[key] = ''\n    }\n\n    Object.assign(this.classStyle, classStyle)\n    const taskCenter = getTaskCenter(this.docId)\n    if (taskCenter) {\n      taskCenter.send(\n        'dom',\n        { action: 'updateStyle' },\n        [this.ref, this.toStyle()]\n      )\n    }\n  }\n\n  /**\n   * Add an event handler.\n   * @param {string} event type\n   * @param {function} event handler\n   */\n  addEvent (type, handler, params) {\n    if (!this.event) {\n      this.event = {}\n    }\n    if (!this.event[type]) {\n      if (checkLevel('debug')) {\n        debugLog(`[addEvent](${this.docId},${this.type},${this.ref}) `\n          + `Add \"${type}\" event on <${this.type}> (${this.ref}).`)\n      }\n      this.event[type] = { handler, params }\n      const taskCenter = getTaskCenter(this.docId)\n      if (taskCenter) {\n        taskCenter.send(\n          'dom',\n          { action: 'addEvent' },\n          [this.ref, type]\n        )\n      }\n    }\n  }\n\n  /**\n   * Remove an event handler.\n   * @param {string} event type\n   */\n  removeEvent (type) {\n    if (this.event && this.event[type]) {\n      if (checkLevel('debug')) {\n        debugLog(`[removeEvent](${this.docId},${this.type},${this.ref}) `\n          + `Remove \"${type}\" event on <${this.type}> (${this.ref}).`)\n      }\n      delete this.event[type]\n      const taskCenter = getTaskCenter(this.docId)\n      if (taskCenter) {\n        taskCenter.send(\n          'dom',\n          { action: 'removeEvent' },\n          [this.ref, type]\n        )\n      }\n    }\n  }\n\n  /**\n   * Fire an event manually.\n   * @param {string} type type\n   * @param {function} event handler\n   * @param {boolean} isBubble whether or not event bubble\n   * @param {boolean} options\n   * @return {} anything returned by handler function\n   */\n  fireEvent (type, event, isBubble, options) {\n    let result = null\n    let isStopPropagation = false\n    const eventDesc = this.event[type]\n    if (eventDesc && event) {\n      if (checkLevel('debug')) {\n        debugLog(`[fireEvent](${this.docId},${this.type},${this.ref}) `\n          + `Fire \"${type}\" event on <${this.type}> (${this.ref}).`)\n      }\n      const handler = eventDesc.handler\n      event.stopPropagation = () => {\n        isStopPropagation = true\n      }\n      try {\n        if (options && options.params) {\n          result = handler.call(this, ...options.params, event)\n        }\n        else {\n          result = handler.call(this, event)\n        }\n      }\n      catch (error) {\n        console.error(`[JS Framework] Failed to invoke the event handler of \"${type}\" `\n          + `on ${this.type} (${this.ref}):\\n ${error.toString()}`)\n        throw error\n      }\n    }\n\n    if (!isStopPropagation\n      && isBubble\n      && (BUBBLE_EVENTS.indexOf(type) !== -1)\n      && this.parentNode\n      && this.parentNode.fireEvent) {\n      event.currentTarget = this.parentNode\n      this.parentNode.fireEvent(type, event, isBubble) // no options\n    }\n\n    return result\n  }\n\n  /**\n   * Get all styles of current element.\n   * @return {object} style\n   */\n  toStyle () {\n    return Object.assign({}, this.classStyle, this.style)\n  }\n\n  /**\n   * Convert current element to JSON like object.\n   * @param {boolean} ignoreChildren whether to ignore child nodes, default false\n   * @return {object} element\n   */\n  toJSON (ignoreChildren = false) {\n    const result = {\n      ref: this.ref.toString(),\n      type: this.type,\n      attr: this.attr,\n      style: this.toStyle()\n    }\n    const event = []\n    for (const type in this.event) {\n      const { params } = this.event[type]\n      if (!params) {\n        event.push(type)\n      }\n      else {\n        event.push({ type, params })\n      }\n    }\n    if (event.length) {\n      result.event = event\n    }\n    if (!ignoreChildren && this.pureChildren.length) {\n      result.children = this.pureChildren.map((child) => child.toJSON())\n    }\n    return result\n  }\n\n  /**\n   * Convert to HTML element tag string.\n   * @return {stirng} html\n   */\n  toString () {\n    return '<' + this.type +\n    ' attr=' + JSON.stringify(this.attr) +\n    ' style=' + JSON.stringify(this.toStyle()) + '>' +\n    this.pureChildren.map((child) => child.toString()).join('') +\n    '</' + this.type + '>'\n  }\n}\n\nsetElement(Element)\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport CallbackManager from './CallbackManager'\nimport Element from '../vdom/Element'\nimport { typof, checkLevel, debugLog } from '../shared/utils'\nimport { normalizePrimitive } from './normalize'\n\nlet fallback = function () {}\n\n// The API of TaskCenter would be re-design.\nexport class TaskCenter {\n  constructor (id, sendTasks) {\n    Object.defineProperty(this, 'instanceId', {\n      enumerable: true,\n      value: String(id)\n    })\n    Object.defineProperty(this, 'callbackManager', {\n      enumerable: true,\n      value: new CallbackManager(id)\n    })\n    fallback = sendTasks || function () {}\n  }\n\n  callback (callbackId, data, ifKeepAlive) {\n    return this.callbackManager.consume(callbackId, data, ifKeepAlive)\n  }\n\n  registerHook (...args) {\n    return this.callbackManager.registerHook(...args)\n  }\n\n  triggerHook (...args) {\n    return this.callbackManager.triggerHook(...args)\n  }\n\n  updateData (componentId, newData, callback) {\n    this.send('module', {\n      module: 'dom',\n      method: 'updateComponentData'\n    }, [componentId, newData, callback])\n  }\n\n  destroyCallback () {\n    return this.callbackManager.close()\n  }\n\n  /**\n   * Normalize a value. Specially, if the value is a function, then generate a function id\n   * and save it to `CallbackManager`, at last return the function id.\n   * @param  {any}        v\n   * @return {primitive}\n   */\n  normalize (v, deep = false) {\n    const type = typof(v)\n    if (v && v instanceof Element) {\n      return v.ref\n    }\n    if (v && v._isVue && v.$el instanceof Element) {\n      return v.$el.ref\n    }\n    if (type === 'Function') {\n      return this.callbackManager.add(v).toString()\n    }\n    if (deep) {\n      if (type === 'Object') {\n        const object = {}\n        for (const key in v) {\n          object[key] = this.normalize(v[key], true)\n        }\n        return object\n      }\n      if (type === 'Array') {\n        return v.map(item => this.normalize(item, true))\n      }\n    }\n    if (v && v.ref && v['[[VirtualElement]]']) {\n      return v.ref\n    }\n    return normalizePrimitive(v)\n  }\n\n  send (type, params, args, options) {\n    const { action, component, ref, module, method } = params\n\n    // normalize args and options\n    args = args.map(arg => this.normalize(arg))\n    if (typof(options) === 'Object') {\n      options = this.normalize(options, true)\n    }\n\n    switch (type) {\n      case 'dom': {\n        if (checkLevel('debug')) {\n          debugLog(`[task](${this.instanceId},${this.type},${action}) ${JSON.stringify(args)}`)\n        }\n        return this[action](this.instanceId, args)\n      }\n      case 'component':\n        return this.componentHandler(this.instanceId, ref, method, args, Object.assign({ component }, options))\n      default: {\n        if (checkLevel('debug')) {\n          debugLog(`[task](${this.instanceId},${module},${method}) ${JSON.stringify(args)}`)\n        }\n        return this.moduleHandler(this.instanceId, module, method, args, options)\n      }\n    }\n  }\n\n  callDOM (action, args) {\n    return this[action](this.instanceId, args)\n  }\n\n  callComponent (ref, method, args, options) {\n    return this.componentHandler(this.instanceId, ref, method, args, options)\n  }\n\n  callModule (module, method, args, options) {\n    return this.moduleHandler(this.instanceId, module, method, args, options)\n  }\n}\n\nexport function init () {\n  const DOM_METHODS = {\n    createFinish: global.callCreateFinish,\n    updateFinish: global.callUpdateFinish,\n    refreshFinish: global.callRefreshFinish,\n\n    createBody: global.callCreateBody,\n\n    addElement: global.callAddElement,\n    removeElement: global.callRemoveElement,\n    moveElement: global.callMoveElement,\n    updateAttrs: global.callUpdateAttrs,\n    updateStyle: global.callUpdateStyle,\n\n    addEvent: global.callAddEvent,\n    removeEvent: global.callRemoveEvent,\n    __updateComponentData: global.__updateComponentData\n  }\n  const proto = TaskCenter.prototype\n\n  for (const name in DOM_METHODS) {\n    const method = DOM_METHODS[name]\n    proto[name] = method ?\n      (id, args) => method(id, ...args) :\n      (id, args) => fallback(id, [{ module: 'dom', method: name, args }], '-1')\n  }\n\n  proto.componentHandler = global.callNativeComponent ||\n    ((id, ref, method, args, options) =>\n      fallback(id, [{ component: options.component, ref, method, args }]))\n\n  proto.moduleHandler = global.callNativeModule ||\n    ((id, module, method, args) =>\n      fallback(id, [{ module, method, args }]))\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { getDoc } from '../vdom/operation'\n\nfunction fireEvent (document, nodeId, type, event, domChanges, params) {\n  const el = document.getRef(nodeId)\n  if (el) {\n    return document.fireEvent(el, type, event, domChanges, params)\n  }\n  else if (event) {\n    event._nodeId = nodeId\n    return document.fireEvent(document.getRef('_documentElement'), type, event, domChanges, params)\n  }\n}\n\nfunction callback (document, callbackId, data, ifKeepAlive) {\n  return document.taskCenter.callback(callbackId, data, ifKeepAlive)\n}\n\nfunction componentHook (document, componentId, type, hook, args) {\n  if (!document || !document.taskCenter) {\n    console.error(`[JS Framework] Can't find \"document\" or \"taskCenter\".`)\n    return null\n  }\n  let result = null\n  try {\n    result = document.taskCenter.triggerHook(componentId, type, hook, args)\n  }\n  catch (e) {\n    console.error(`[JS Framework] Failed to trigger the \"${type}@${hook}\" hook on ${componentId}.`)\n\n    // Still throw the exception anyway, it should be caught\n    // and processed by the native for consistent error collecting.\n    throw e\n  }\n  return result\n}\n\n/**\n * Accept calls from native (event or callback).\n *\n * @param  {string} id\n * @param  {array} tasks list with `method` and `args`\n */\nexport function receiveTasks (id, tasks) {\n  const document = getDoc(id)\n  if (!document) {\n    return new Error(`[JS Framework] Failed to receiveTasks, `\n      + `instance (${id}) is not available.`)\n  }\n  if (Array.isArray(tasks)) {\n    return tasks.map(task => {\n      switch (task.method) {\n        case 'callback': return callback(document, ...task.args)\n        case 'fireEventSync':\n        case 'fireEvent': return fireEvent(document, ...task.args)\n        case 'componentHook': return componentHook(document, ...task.args)\n      }\n    })\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { typof, bufferToBase64, base64ToBuffer } from '../shared/utils'\n\n/**\n * Normalize a primitive value.\n * @param  {any}        v\n * @return {primitive}\n */\nexport function normalizePrimitive (v) {\n  const type = typof(v)\n\n  switch (type) {\n    case 'Undefined':\n    case 'Null':\n      return ''\n\n    case 'RegExp':\n      return v.toString()\n    case 'Date':\n      return v.toISOString()\n\n    case 'Number':\n    case 'String':\n    case 'Boolean':\n    case 'Array':\n    case 'Object':\n      return v\n\n    case 'ArrayBuffer':\n      return {\n        '@type': 'binary',\n        dataType: type,\n        base64: bufferToBase64(v)\n      }\n\n    case 'Int8Array':\n    case 'Uint8Array':\n    case 'Uint8ClampedArray':\n    case 'Int16Array':\n    case 'Uint16Array':\n    case 'Int32Array':\n    case 'Uint32Array':\n    case 'Float32Array':\n    case 'Float64Array':\n      return {\n        '@type': 'binary',\n        dataType: type,\n        base64: bufferToBase64(v.buffer)\n      }\n\n    default:\n      return JSON.stringify(v)\n  }\n}\n\nexport function decodePrimitive (data) {\n  if (typof(data) === 'Object') {\n    // decode base64 into binary\n    if (data['@type'] && data['@type'] === 'binary') {\n      return base64ToBuffer(data.base64 || '')\n    }\n\n    const realData = {}\n    for (const key in data) {\n      realData[key] = decodePrimitive(data[key])\n    }\n    return realData\n  }\n  if (typof(data) === 'Array') {\n    return data.map(decodePrimitive)\n  }\n  return data\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { hasOwn, isPlainObject } from '../shared/utils'\n\nconst weexModules = {}\n\n/**\n * Register native modules information.\n * @param {object} newModules\n */\nexport function registerModules (newModules = {}) {\n  for (const name in newModules) {\n    if (!hasOwn(weexModules, name)) {\n      weexModules[name] = {}\n    }\n    if (Array.isArray(newModules[name])) {\n      newModules[name].forEach(method => {\n        if (typeof method === 'string') {\n          weexModules[name][method] = true\n        }\n        else if (isPlainObject(method) && typeof method.name === 'string') {\n          weexModules[name][method.name] = method.args || []\n        }\n      })\n    }\n  }\n}\n\n/**\n * Check whether the module or the method has been registered.\n * @param {String} module name\n * @param {String} method name (optional)\n */\nexport function isRegisteredModule (name, method) {\n  if (typeof method === 'string') {\n    return !!(weexModules[name] && weexModules[name][method])\n  }\n  return !!weexModules[name]\n}\n\nexport function getModuleDescription (name) {\n  return weexModules[name]\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { isPlainObject } from '../shared/utils'\nimport { registerElement } from '../vdom/WeexElement'\n\nconst weexComponents = {}\n\n/**\n * Register native components information.\n * @param {array} newComponents\n */\nexport function registerComponents(newComponents) {\n  if (Array.isArray(newComponents)) {\n    newComponents.forEach(component => {\n      if (!component) {\n        return\n      }\n      if (typeof component === 'string') {\n        weexComponents[component] = true\n      }\n      else if (isPlainObject(component) && typeof component.type === 'string') {\n        weexComponents[component.type] = component\n        registerElement(component.type, component.methods)\n      }\n    })\n  }\n  return 'wtf'\n}\n\n/**\n * Check whether the component has been registered.\n * @param {String} component name\n */\nexport function isRegisteredComponent(name) {\n  return !!weexComponents[name]\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n// JS Services\n\nexport const services = []\n\n/**\n * Register a JavaScript service.\n * A JavaScript service options could have a set of lifecycle methods\n * for each Weex instance. For example: create, refresh, destroy.\n * For the JS framework maintainer if you want to supply some features\n * which need to work well in different Weex instances, even in different\n * frameworks separately. You can make a JavaScript service to init\n * its variables or classes for each Weex instance when it's created\n * and recycle them when it's destroyed.\n * @param {object} options Could have { create, refresh, destroy }\n *                         lifecycle methods. In create method it should\n *                         return an object of what variables or classes\n *                         would be injected into the Weex instance.\n */\nexport function register (name, options) {\n  if (has(name)) {\n    console.warn(`Service \"${name}\" has been registered already!`)\n  }\n  else {\n    options = Object.assign({}, options)\n    services.push({ name, options })\n  }\n}\n\n/**\n * Unregister a JavaScript service by name\n * @param {string} name\n */\nexport function unregister (name) {\n  services.some((service, index) => {\n    if (service.name === name) {\n      services.splice(index, 1)\n      return true\n    }\n  })\n}\n\n/**\n * Check if a JavaScript service with a certain name existed.\n * @param  {string}  name\n * @return {Boolean}\n */\nexport function has (name) {\n  return indexOf(name) >= 0\n}\n\n/**\n * Find the index of a JavaScript service by name\n * @param  {string} name\n * @return {number}\n */\nfunction indexOf (name) {\n  return services.map(service => service.name).indexOf(name)\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport Node from './Node'\nimport { uniqueId } from '../shared/utils'\n\nexport default class Comment extends Node {\n  constructor (value) {\n    super()\n\n    this.nodeType = 8\n    this.nodeId = uniqueId()\n    this.ref = this.nodeId\n    this.type = 'comment'\n    this.value = value\n    this.children = []\n    this.pureChildren = []\n  }\n\n  /**\n  * Convert to HTML comment string.\n  * @return {stirng} html\n  */\n  toString () {\n    return '<!-- ' + this.value + ' -->'\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/**\n* Create the action object.\n* @param {string} name\n* @param {array} arguments\n* @return {object} action\n*/\nfunction createAction (name, args = []) {\n  return { module: 'dom', method: name, args: args }\n}\n\nexport default class Listener {\n  constructor (id, handler) {\n    this.id = id\n    this.batched = false\n    this.updates = []\n    if (typeof handler === 'function') {\n      Object.defineProperty(this, 'handler', {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value: handler\n      })\n    }\n    else {\n      console.error('[JS Runtime] invalid parameter, handler must be a function')\n    }\n  }\n\n  /**\n   * Send the \"createFinish\" signal.\n   * @param {function} callback\n   * @return {undefined | number} the signal sent by native\n   */\n  createFinish (callback) {\n    const handler = this.handler\n    return handler([createAction('createFinish')], callback)\n  }\n\n  /**\n   * Send the \"updateFinish\" signal.\n   * @param {function} callback\n   * @return {undefined | number} the signal sent by native\n   */\n  updateFinish (callback) {\n    const handler = this.handler\n    return handler([createAction('updateFinish')], callback)\n  }\n\n  /**\n   * Send the \"refreshFinish\" signal.\n   * @param {function} callback\n   * @return {undefined | number} the signal sent by native\n   */\n  refreshFinish (callback) {\n    const handler = this.handler\n    return handler([createAction('refreshFinish')], callback)\n  }\n\n  /**\n   * Send the \"createBody\" signal.\n   * @param {object} element\n   * @return {undefined | number} the signal sent by native\n   */\n  createBody (element) {\n    const body = element.toJSON()\n    const children = body.children\n    delete body.children\n    const actions = [createAction('createBody', [body])]\n    if (children) {\n      actions.push.apply(actions, children.map(child => {\n        return createAction('addElement', [body.ref, child, -1])\n      }))\n    }\n    return this.addActions(actions)\n  }\n\n  /**\n   * Send the \"addElement\" signal.\n   * @param {object} element\n   * @param {stirng} reference id\n   * @param {number} index\n   * @return {undefined | number} the signal sent by native\n   */\n  addElement (element, ref, index) {\n    if (!(index >= 0)) {\n      index = -1\n    }\n    return this.addActions(createAction('addElement', [ref, element.toJSON(), index]))\n  }\n\n  /**\n   * Send the \"removeElement\" signal.\n   * @param {stirng} reference id\n   * @return {undefined | number} the signal sent by native\n   */\n  removeElement (ref) {\n    if (Array.isArray(ref)) {\n      const actions = ref.map((r) => createAction('removeElement', [r]))\n      return this.addActions(actions)\n    }\n    return this.addActions(createAction('removeElement', [ref]))\n  }\n\n  /**\n   * Send the \"moveElement\" signal.\n   * @param {stirng} target reference id\n   * @param {stirng} parent reference id\n   * @param {number} index\n   * @return {undefined | number} the signal sent by native\n   */\n  moveElement (targetRef, parentRef, index) {\n    return this.addActions(createAction('moveElement', [targetRef, parentRef, index]))\n  }\n\n  /**\n   * Send the \"updateAttrs\" signal.\n   * @param {stirng} reference id\n   * @param {stirng} key\n   * @param {stirng} value\n   * @return {undefined | number} the signal sent by native\n   */\n  setAttr (ref, key, value) {\n    const result = {}\n    result[key] = value\n    return this.addActions(createAction('updateAttrs', [ref, result]))\n  }\n\n  /**\n   * Send the \"updateStyle\" signal, update a sole style.\n   * @param {stirng} reference id\n   * @param {stirng} key\n   * @param {stirng} value\n   * @return {undefined | number} the signal sent by native\n   */\n  setStyle (ref, key, value) {\n    const result = {}\n    result[key] = value\n    return this.addActions(createAction('updateStyle', [ref, result]))\n  }\n\n  /**\n   * Send the \"updateStyle\" signal.\n   * @param {stirng} reference id\n   * @param {object} style\n   * @return {undefined | number} the signal sent by native\n   */\n  setStyles (ref, style) {\n    return this.addActions(createAction('updateStyle', [ref, style]))\n  }\n\n  /**\n   * Send the \"addEvent\" signal.\n   * @param {stirng} reference id\n   * @param {string} event type\n   * @return {undefined | number} the signal sent by native\n   */\n  addEvent (ref, type) {\n    return this.addActions(createAction('addEvent', [ref, type]))\n  }\n\n  /**\n   * Send the \"removeEvent\" signal.\n   * @param {stirng} reference id\n   * @param {string} event type\n   * @return {undefined | number} the signal sent by native\n   */\n  removeEvent (ref, type) {\n    return this.addActions(createAction('removeEvent', [ref, type]))\n  }\n\n  /**\n   * Default handler.\n   * @param {object | array} actions\n   * @param {function} callback\n   * @return {} anything returned by callback function\n   */\n  handler (actions, cb) {\n    return cb && cb()\n  }\n\n  /**\n   * Add actions into updates.\n   * @param {object | array} actions\n   * @return {undefined | number} the signal sent by native\n   */\n  addActions (actions) {\n    const updates = this.updates\n    const handler = this.handler\n\n    if (!Array.isArray(actions)) {\n      actions = [actions]\n    }\n\n    if (this.batched) {\n      updates.push.apply(updates, actions)\n    }\n    else {\n      return handler(actions)\n    }\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/**\n * @fileOverview\n * Task handler for communication between javascript and native.\n */\n\nconst handlerMap = {\n  createBody: 'callCreateBody',\n  addElement: 'callAddElement',\n  removeElement: 'callRemoveElement',\n  moveElement: 'callMoveElement',\n  updateAttrs: 'callUpdateAttrs',\n  updateStyle: 'callUpdateStyle',\n  addEvent: 'callAddEvent',\n  removeEvent: 'callRemoveEvent'\n}\n\n/**\n * Create a task handler.\n * @param {string} id\n * @param {function} handler\n * @return {function} taskHandler\n */\nexport function createHandler (id, handler) {\n  const defaultHandler = handler || global.callNative\n\n  /* istanbul ignore if */\n  if (typeof defaultHandler !== 'function') {\n    console.error('[JS Runtime] no default handler')\n  }\n\n  return function taskHandler (tasks) {\n    /* istanbul ignore if */\n    if (!Array.isArray(tasks)) {\n      tasks = [tasks]\n    }\n    for (let i = 0; i < tasks.length; i++) {\n      const returnValue = dispatchTask(id, tasks[i], defaultHandler)\n      if (returnValue === -1) {\n        return returnValue\n      }\n    }\n  }\n}\n\n/**\n * Check if there is a corresponding available handler in the environment.\n * @param {string} module\n * @param {string} method\n * @return {boolean}\n */\nfunction hasAvailableHandler (module, method) {\n  return module === 'dom'\n    && handlerMap[method]\n    && typeof global[handlerMap[method]] === 'function'\n}\n\n/**\n * Dispatch the task to the specified handler.\n * @param {string} id\n * @param {object} task\n * @param {function} defaultHandler\n * @return {number} signal returned from native\n */\nfunction dispatchTask (id, task, defaultHandler) {\n  const { module, method, args } = task\n\n  if (hasAvailableHandler(module, method)) {\n    return global[handlerMap[method]](id, ...args, '-1')\n  }\n\n  return defaultHandler(id, [task], '-1')\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport Comment from './Comment'\nimport Element from './Element'\nimport Listener from '../bridge/Listener'\nimport { checkLevel, debugLog } from '../shared/utils'\nimport { TaskCenter } from '../bridge/TaskCenter'\nimport { createHandler } from '../bridge/Handler'\nimport { addDoc, removeDoc, appendBody, setBody } from './operation'\n\n/**\n * Update all changes for an element.\n * @param {object} element\n * @param {object} changes\n */\nfunction updateElement (el, changes) {\n  const attrs = changes.attrs || {}\n  for (const name in attrs) {\n    el.setAttr(name, attrs[name], true)\n  }\n  const style = changes.style || {}\n  for (const name in style) {\n    el.setStyle(name, style[name], true)\n  }\n}\n\nexport default class Document {\n  constructor (id, url, handler) {\n    id = id ? id.toString() : ''\n    this.id = id\n    this.URL = url\n\n    addDoc(id, this)\n    this.nodeMap = {}\n    const L = Document.Listener || Listener\n    this.listener = new L(id, handler || createHandler(id, Document.handler)) // deprecated\n    this.taskCenter = new TaskCenter(id, handler ? (id, ...args) => handler(...args) : Document.handler)\n    this.createDocumentElement()\n  }\n\n  /**\n  * Get the node from nodeMap.\n  * @param {string} reference id\n  * @return {object} node\n  */\n  getRef (ref) {\n    return this.nodeMap[ref]\n  }\n\n  /**\n  * Turn on batched updates.\n  */\n  open () {\n    this.listener.batched = false\n  }\n\n  /**\n  * Turn off batched updates.\n  */\n  close () {\n    this.listener.batched = true\n  }\n\n  /**\n  * Create the document element.\n  * @return {object} documentElement\n  */\n  createDocumentElement () {\n    if (!this.documentElement) {\n      const el = new Element('document')\n      el.docId = this.id\n      el.ownerDocument = this\n      el.role = 'documentElement'\n      el.depth = 0\n      el.ref = '_documentElement'\n      this.nodeMap._documentElement = el\n      this.documentElement = el\n\n      Object.defineProperty(el, 'appendChild', {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value: (node) => {\n          appendBody(this, node)\n        }\n      })\n\n      Object.defineProperty(el, 'insertBefore', {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value: (node, before) => {\n          appendBody(this, node, before)\n        }\n      })\n\n      if (checkLevel('debug')) {\n        debugLog(`Create document element (id: \"${el.docId}\", ref: \"${el.ref}\")`)\n      }\n    }\n\n    return this.documentElement\n  }\n\n  /**\n  * Create the body element.\n  * @param {string} type\n  * @param {objct} props\n  * @return {object} body element\n  */\n  createBody (type, props) {\n    if (!this.body) {\n      const el = new Element(type, props)\n      setBody(this, el)\n      if (checkLevel('debug')) {\n        debugLog(`[createBody](${this.id},${el.type},${el.ref}) `\n          + `(${JSON.stringify(el.toJSON(true))}).`)\n      }\n    }\n\n    return this.body\n  }\n\n  /**\n  * Create an element.\n  * @param {string} tagName\n  * @param {objct} props\n  * @return {object} element\n  */\n  createElement (tagName, props) {\n    const el = new Element(tagName, props)\n    if (checkLevel('debug')) {\n      debugLog(`[createElement](${this.id},${el.type},${el.ref}) `\n        + `(${JSON.stringify(el.toJSON(true))}).`)\n    }\n    return el\n  }\n\n  /**\n  * Create an comment.\n  * @param {string} text\n  * @return {object} comment\n  */\n  createComment (text) {\n    return new Comment(text)\n  }\n\n  /**\n  * Fire an event on specified element manually.\n  * @param {object} element\n  * @param {string} event type\n  * @param {object} event object\n  * @param {object} dom changes\n  * @param {object} options\n  * @return {} anything returned by handler function\n  */\n  fireEvent (el, type, event, domChanges, options) {\n    if (!el) {\n      return\n    }\n    event = event || {}\n    event.type = event.type || type\n    event.target = el\n    event.currentTarget = el\n    event.timestamp = Date.now()\n    if (domChanges) {\n      updateElement(el, domChanges)\n    }\n    let isBubble\n    const $root = this.getRef('_root')\n    if ($root && $root.attr) {\n      isBubble = $root.attr['bubble'] === 'true'\n    }\n    return el.fireEvent(type, event, isBubble, options)\n  }\n\n  /**\n  * Destroy current document, and remove itself form docMap.\n  */\n  destroy () {\n    if (checkLevel('debug')) {\n      debugLog(`[destroy](${this.id},document,${this.ref}) `\n        + `Destroy document (id: \"${this.id}\", URL: \"${this.URL}\")`)\n    }\n    this.taskCenter.destroyCallback()\n    delete this.listener\n    delete this.nodeMap\n    delete this.taskCenter\n    removeDoc(this.id)\n  }\n}\n\n// default task handler\nDocument.handler = null\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport Document from '../vdom/Document'\nimport { isRegisteredModule, getModuleDescription } from './module'\nimport { isRegisteredComponent } from './component'\nimport { getTaskCenter } from '../vdom/operation'\n\nfunction setId (weex, id) {\n  Object.defineProperty(weex, '[[CurrentInstanceId]]', { value: id })\n}\n\nfunction getId (weex) {\n  return weex['[[CurrentInstanceId]]']\n}\n\nfunction moduleGetter (id, module, method) {\n  const taskCenter = getTaskCenter(id)\n  if (!taskCenter || typeof taskCenter.send !== 'function') {\n    console.error(`[JS Framework] Failed to find taskCenter (${id}).`)\n    return null\n  }\n  return (...args) => taskCenter.send('module', { module, method }, args)\n}\n\nfunction moduleSetter (id, module, method, fn) {\n  const taskCenter = getTaskCenter(id)\n  if (!taskCenter || typeof taskCenter.send !== 'function') {\n    console.error(`[JS Framework] Failed to find taskCenter (${id}).`)\n    return null\n  }\n  if (typeof fn !== 'function') {\n    console.error(`[JS Framework] ${module}.${method} must be assigned as a function.`)\n    return null\n  }\n  return fn => taskCenter.send('module', { module, method }, [fn])\n}\n\nexport default class WeexInstance {\n  constructor (id, config, data) {\n    setId(this, String(id))\n    this.config = config || {}\n    this._nativeData = data || {}\n    this.document = new Document(id, this.config.bundleUrl)\n    this.requireModule = this.requireModule.bind(this)\n    this.importScript = this.importScript.bind(this)\n    this.isRegisteredModule = isRegisteredModule\n    this.isRegisteredComponent = isRegisteredComponent\n  }\n\n  requireModule (moduleName) {\n    const id = getId(this)\n    if (!(id && this.document && this.document.taskCenter)) {\n      console.error(`[JS Framework] Failed to requireModule(\"${moduleName}\"), `\n        + `instance (${id}) doesn't exist anymore.`)\n      return\n    }\n\n    // warn for unknown module\n    if (!isRegisteredModule(moduleName)) {\n      console.warn(`[JS Framework] using unregistered weex module \"${moduleName}\"`)\n      return\n    }\n\n    // create registered module apis\n    const moduleProxy = {}\n    const moduleDefine = getModuleDescription(moduleName)\n    for (const methodName in moduleDefine) {\n      Object.defineProperty(moduleProxy, methodName, {\n        enumerable: true,\n        configurable: true,\n        get: () => moduleGetter(id, moduleName, methodName),\n        set: fn => moduleSetter(id, moduleName, methodName, fn)\n      })\n    }\n\n    return moduleProxy\n  }\n\n  supports (condition) {\n    if (typeof condition !== 'string') return null\n\n    const res = condition.match(/^@(\\w+)\\/([\\w-]+)(\\.(\\w+))?$/i)\n    if (res) {\n      const type = res[1]\n      const name = res[2]\n      const method = res[4]\n      switch (type) {\n        case 'module': return isRegisteredModule(name, method)\n        case 'component': return isRegisteredComponent(name)\n      }\n    }\n\n    return null\n  }\n\n  importScript (src, options = {}) {\n    const id = getId(this)\n    const taskCenter = getTaskCenter(id)\n    return new Promise(function (resolve, reject) {\n      if (!taskCenter || typeof taskCenter.send !== 'function') {\n        reject(new Error(`[JS Framework] Failed to import script \"${src}\", `\n          + `no taskCenter (${id}) matched.`))\n      }\n      try {\n        taskCenter.send('module', {\n          module: 'script',\n          method: 'importScript'\n        }, [src, options], {\n          callback: [\n            result => resolve(result),\n            error => reject(error)\n          ]\n        })\n      }\n      catch (e) {\n        reject(e)\n      }\n    })\n  }\n\n  // registerStyleSheet (styles) {\n  //   if (this.document) {\n  //     this.document.registerStyleSheet(styles)\n  //   }\n  // }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { init as initTaskHandler } from '../bridge/TaskCenter'\nimport { receiveTasks } from '../bridge/receiver'\nimport { registerModules } from './module'\nimport { registerComponents } from './component'\nimport { services, register, unregister } from './service'\nimport WeexInstance from './WeexInstance'\nimport { getDoc } from '../vdom/operation'\n\nlet frameworks\nlet runtimeConfig\n\nconst versionRegExp = /^\\s*\\/\\/ *(\\{[^}]*\\}) *\\r?\\n/\n\n/**\n * Detect a JS Bundle code and make sure which framework it's based to. Each JS\n * Bundle should make sure that it starts with a line of JSON comment and is\n * more that one line.\n * @param  {string} code\n * @return {object}\n */\nfunction getBundleType (code) {\n  const result = versionRegExp.exec(code)\n  if (result) {\n    try {\n      const info = JSON.parse(result[1])\n      return info.framework\n    }\n    catch (e) {}\n  }\n\n  // default bundle type\n  return 'Weex'\n}\n\n/**\n * Get js framework version at runtime.\n */\nfunction getJSFMVersion () {\n  // It will be converted into a version string at build time\n  return __WEEX_JS_FRAMEWORK_VERSION__ // eslint-disable-line\n}\n\nfunction createServices (id, env, config) {\n  // Init JavaScript services for this instance.\n  const serviceMap = Object.create(null)\n  serviceMap.service = Object.create(null)\n  services.forEach(({ name, options }) => {\n    if (process.env.NODE_ENV === 'development') {\n      console.debug(`[JS Runtime] create service ${name}.`)\n    }\n    const create = options.create\n    if (create) {\n      try {\n        const result = create(id, env, config)\n        Object.assign(serviceMap.service, result)\n        Object.assign(serviceMap, result.instance)\n      }\n      catch (e) {\n        console.error(`[JS Runtime] Failed to create service ${name}.`)\n      }\n    }\n  })\n  delete serviceMap.service.instance\n  Object.freeze(serviceMap.service)\n  return serviceMap\n}\n\nconst instanceTypeMap = {}\nfunction getFrameworkType (id) {\n  return instanceTypeMap[id]\n}\n\nfunction createInstanceContext (id, options = {}, data) {\n  const weex = new WeexInstance(id, options, data)\n\n  const bundleType = options.bundleType || 'Vue'\n  instanceTypeMap[id] = bundleType\n  const framework = runtimeConfig.frameworks[bundleType]\n  if (!framework) {\n    return new Error(`[JS Framework] Invalid bundle type \"${bundleType}\".`)\n  }\n\n  // prepare js service\n  const services = createServices(id, {\n    weex,\n    config: options,\n    created: Date.now(),\n    framework: bundleType,\n    bundleType\n  }, runtimeConfig)\n  Object.freeze(services)\n\n  // prepare runtime context\n  const runtimeContext = Object.create(null)\n  Object.assign(runtimeContext, services, {\n    weex,\n    getJSFMVersion,\n    requireModule: (...args) => weex.requireModule(...args),\n    __WEEX_CALL_JAVASCRIPT__: receiveTasks,\n    services // Temporary compatible with some legacy APIs in Rax\n  })\n  Object.freeze(runtimeContext)\n\n  // prepare instance context\n  const instanceContext = Object.assign({}, runtimeContext)\n  if (typeof framework.createInstanceContext === 'function') {\n    Object.assign(instanceContext, framework.createInstanceContext(id, runtimeContext, data))\n  }\n  Object.freeze(instanceContext)\n  return instanceContext\n}\n\n/**\n * Check which framework a certain JS Bundle code based to. And create instance\n * by this framework.\n * @param {string} id\n * @param {string} code\n * @param {object} config\n * @param {object} data\n */\nfunction createInstance (id, code, config, data) {\n  if (instanceTypeMap[id]) {\n    return new Error(`The instance id \"${id}\" has already been used!`)\n  }\n\n  // Init instance info.\n  const bundleType = getBundleType(code)\n  instanceTypeMap[id] = bundleType\n\n  // Init instance config.\n  config = JSON.parse(JSON.stringify(config || {}))\n  config.env = JSON.parse(JSON.stringify(global.WXEnvironment || {}))\n  config.bundleType = bundleType\n\n  const framework = runtimeConfig.frameworks[bundleType]\n  if (!framework) {\n    return new Error(`[JS Framework] Invalid bundle type \"${bundleType}\".`)\n  }\n  if (bundleType === 'Weex') {\n    console.error(`[JS Framework] COMPATIBILITY WARNING: `\n      + `Weex DSL 1.0 (.we) framework is no longer supported! `\n      + `It will be removed in the next version of WeexSDK, `\n      + `your page would be crash if you still using the \".we\" framework. `\n      + `Please upgrade it to Vue.js or Rax.`)\n  }\n\n  const instanceContext = createInstanceContext(id, config, data)\n  if (typeof framework.createInstance === 'function') {\n    // Temporary compatible with some legacy APIs in Rax,\n    // some Rax page is using the legacy \".we\" framework.\n    if (bundleType === 'Rax' || bundleType === 'Weex') {\n      const raxInstanceContext = Object.assign({\n        config,\n        created: Date.now(),\n        framework: bundleType\n      }, instanceContext)\n      return framework.createInstance(id, code, config, data, raxInstanceContext)\n    }\n    return framework.createInstance(id, code, config, data, instanceContext)\n  }\n  // console.error(`[JS Framework] Can't find available \"createInstance\" method in ${bundleType}!`)\n  runInContext(code, instanceContext)\n}\n\n/**\n * Run js code in a specific context.\n * @param {string} code\n * @param {object} context\n */\nfunction runInContext (code, context) {\n  const keys = []\n  const args = []\n  for (const key in context) {\n    keys.push(key)\n    args.push(context[key])\n  }\n\n  const bundle = `\n    (function (global) {\n      ${code}\n    })(Object.create(this))\n  `\n\n  return (new Function(...keys, bundle))(...args)\n}\n\n/**\n * Get the JSON object of the root element.\n * @param {string} instanceId\n */\nfunction getRoot (instanceId) {\n  const document = getDoc(instanceId)\n  try {\n    if (document && document.body) {\n      return document.body.toJSON()\n    }\n  }\n  catch (e) {\n    console.error(`[JS Framework] Failed to get the virtual dom tree.`)\n    return\n  }\n}\n\nconst methods = {\n  createInstance,\n  createInstanceContext,\n  getRoot,\n  getJSFMVersion,\n  getDocument: getDoc,\n  registerService: register,\n  unregisterService: unregister,\n  callJS (id, tasks) {\n    const framework = frameworks[getFrameworkType(id)]\n    if (framework && typeof framework.receiveTasks === 'function') {\n      return framework.receiveTasks(id, tasks)\n    }\n    return receiveTasks(id, tasks)\n  }\n}\n\n/**\n * Register methods which will be called for each instance.\n * @param {string} methodName\n */\nfunction genInstance (methodName) {\n  methods[methodName] = function (...args) {\n    const id = args[0]\n    const type = getFrameworkType(id)\n    if (type && frameworks[type]) {\n      const result = frameworks[type][methodName](...args)\n      const info = { framework: type }\n\n      // Lifecycle methods\n      if (methodName === 'refreshInstance') {\n        services.forEach(service => {\n          const refresh = service.options.refresh\n          if (refresh) {\n            refresh(id, { info, runtime: runtimeConfig })\n          }\n        })\n      }\n      else if (methodName === 'destroyInstance') {\n        services.forEach(service => {\n          const destroy = service.options.destroy\n          if (destroy) {\n            destroy(id, { info, runtime: runtimeConfig })\n          }\n        })\n        delete instanceTypeMap[id]\n      }\n\n      return result\n    }\n    return new Error(`[JS Framework] Using invalid instance id `\n      + `\"${id}\" when calling ${methodName}.`)\n  }\n}\n\n/**\n * Register methods which init each frameworks.\n * @param {string} methodName\n * @param {function} sharedMethod\n */\nfunction adaptMethod (methodName, sharedMethod) {\n  methods[methodName] = function (...args) {\n    if (typeof sharedMethod === 'function') {\n      sharedMethod(...args)\n    }\n\n    // TODO: deprecated\n    for (const name in runtimeConfig.frameworks) {\n      const framework = runtimeConfig.frameworks[name]\n      if (framework && framework[methodName]) {\n        framework[methodName](...args)\n      }\n    }\n  }\n}\n\nexport default function init (config) {\n  runtimeConfig = config || {}\n  frameworks = runtimeConfig.frameworks || {}\n  initTaskHandler()\n\n  // Init each framework by `init` method and `config` which contains three\n  // virtual-DOM Class: `Document`, `Element` & `Comment`, and a JS bridge method:\n  // `sendTasks(...args)`.\n  for (const name in frameworks) {\n    const framework = frameworks[name]\n    if (typeof framework.init === 'function') {\n      try {\n        framework.init(config)\n      }\n      catch (e) {}\n    }\n  }\n\n  adaptMethod('registerComponents', registerComponents)\n  adaptMethod('registerModules', registerModules)\n  adaptMethod('registerMethods')\n\n  ; ['destroyInstance', 'refreshInstance'].forEach(genInstance)\n\n  return methods\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Document, Element, Comment } from '../vdom'\nimport Listener from '../bridge/Listener'\nimport { TaskCenter } from '../bridge/TaskCenter'\n\nconst config = {\n  Document, Element, Comment, Listener,\n  TaskCenter,\n  sendTasks (...args) {\n    if (typeof callNative === 'function') {\n      return callNative(...args)\n    }\n    return (global.callNative || (() => {}))(...args)\n  }\n}\n\nDocument.handler = config.sendTasks\n\nexport default config\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport init from './init'\nimport config from './config'\nimport { register, unregister, has } from './service'\n\n/* istanbul ignore next */\nfunction freezePrototype () {\n  // Object.freeze(config.Element)\n  Object.freeze(config.Comment)\n  Object.freeze(config.Listener)\n  Object.freeze(config.Document.prototype)\n  // Object.freeze(config.Element.prototype)\n  Object.freeze(config.Comment.prototype)\n  Object.freeze(config.Listener.prototype)\n}\n\nexport default {\n  service: { register, unregister, has },\n  freezePrototype,\n  init,\n  config\n}\n"],"names":["getHookKey","componentId","type","hookName","CallbackManager","instanceId","this","String","lastCallbackId","callbacks","hooks","add","callback","remove","callbackId","registerHook","hookFunction","key","console","warn","triggerHook","args","error","result","apply","e","consume","data","ifKeepAlive","call","toString","Error","close","let","nextNodeRef","uniqueId","typof","v","s","Object","prototype","substring","length","isPlainObject","value","bufferToBase64","buffer","btoa","string","Array","map","Uint8Array","code","fromCharCode","join","isEmpty","any","const","hasOwnProperty","levelMap","checkLevel","logLevel","global","WXEnvironment","debugLog","text","nativeLog","docMap","getDoc","id","getTaskCenter","doc","taskCenter","appendBody","node","before","children","documentElement","pureChildren","parentNode","beforeIndex","indexOf","push","splice","nodeType","role","docId","ownerDocument","linkParent","forEach","child","setBody","nodeMap","nodeId","body","toJSON","send","action","sendBody","ref","el","depth","_root","parent","nextElement","nextSibling","previousElement","previousSibling","insertIndex","target","list","newIndex","changeSibling","after","moveIndex","index","newIndexAfter","beforeNew","afterNew","removeIndex","Node","Element","destroy","registeredElements","BUBBLE_EVENTS","registerNode","appendChild","insertBefore","pureBefore","insertAfter","removeChild","preserved","clear","setAttr","silent","attr","setAttrs","batchedAttrs","mutations","setStyle","style","setStyles","batchedStyles","setClassStyle","classStyle","assign","toStyle","addEvent","handler","params","event","removeEvent","fireEvent","isBubble","options","isStopPropagation","eventDesc","stopPropagation","currentTarget","ignoreChildren","JSON","stringify","props","isExtended","super","WeexElement","fallback","TaskCenter","sendTasks","defineProperty","enumerable","receiveTasks","tasks","document","isArray","task","method","domChanges","getRef","_nodeId","hook","callbackManager","updateData","newData","module","destroyCallback","normalize","deep","_isVue","$el","object","item","toISOString","@type","dataType","base64","normalizePrimitive","component","arg","componentHandler","moduleHandler","callDOM","callComponent","callModule","weexModules","registerModules","newModules","name","isRegisteredModule","weexComponents","registerComponents","newComponents","methods","methodName","isRegisteredComponent","services","register","has","unregister","some","service","Comment","createAction","Listener","batched","updates","configurable","writable","createFinish","updateFinish","refreshFinish","createBody","element","actions","addActions","addElement","removeElement","r","moveElement","targetRef","parentRef","cb","handlerMap","updateAttrs","updateStyle","createHandler","defaultHandler","callNative","i","returnValue","hasAvailableHandler","dispatchTask","Document","url","URL","L","listener","createDocumentElement","getId","weex","open","_documentElement","createElement","tagName","createComment","timestamp","Date","now","changes","attrs","updateElement","$root","frameworks","runtimeConfig","WeexInstance","config","_nativeData","bundleUrl","requireModule","bind","importScript","moduleName","moduleProxy","get","set","fn","supports","condition","res","match","src","Promise","resolve","reject","versionRegExp","getJSFMVersion","instanceTypeMap","getFrameworkType","createInstanceContext","bundleType","framework","env","serviceMap","created","create","instance","freeze","runtimeContext","__WEEX_CALL_JAVASCRIPT__","instanceContext","exec","parse","getBundleType","createInstance","raxInstanceContext","context","keys","bundle","Function","runInContext","getDocument","registerService","unregisterService","callJS","genInstance","info","refresh","runtime","adaptMethod","sharedMethod","DOM_METHODS","callCreateFinish","callUpdateFinish","callRefreshFinish","callCreateBody","callAddElement","callRemoveElement","callMoveElement","callUpdateAttrs","callUpdateStyle","callAddEvent","callRemoveEvent","__updateComponentData","proto","callNativeComponent","callNativeModule","initTaskHandler","init"],"mappings":"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"}